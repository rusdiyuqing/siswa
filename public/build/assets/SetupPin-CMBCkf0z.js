import{K as q,r as i,m as V,j as e,L as z}from"./app-D-XfHT6J.js";import{c as O,M as U}from"./Modal-Bda5df7O.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],J=O("ArrowLeft",G);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],W=O("EyeOff",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Y=O("Eye",X),Z=(a,l=2)=>{if(a.length<=l*2)return a;const v=a.substring(0,4),b=a.substring(a.length-l),k="*".repeat(a.length-l*2);return`${v}${k}${b}`},ne=({setHasPined:a,hasPin:l,open:v,onClose:b})=>{const{siswa:k,message:w,errors:o,nouid:p}=q().props,[f,y]=i.useState("phone"),[x,P]=i.useState(0),{data:s,setData:S,post:j,processing:u,reset:T}=V({phone:"",otp:"",pin:"",pin_confirmation:""}),[N,D]=i.useState("password"),d=i.useRef(Array(6).fill(null)),h=i.useRef(Array(6).fill(null)),g=i.useRef(Array(6).fill(null));i.useEffect(()=>{if(x>0){const r=setTimeout(()=>P(x-1),1e3);return()=>clearTimeout(r)}},[x]);const K=r=>{r.preventDefault();const t=l?route("siswa.forgot-pin",{nouid:p}):route("otp.send",{nouid:p});j(t,{onSuccess:()=>{y("otp"),P(60),d.current[0]&&d.current[0].focus()}})},I=r=>{r.preventDefault(),j(`/${p}/otp/verify`,{onSuccess:()=>{y("pin"),h.current[0]&&h.current[0].focus()}})},F=r=>{r.preventDefault(),j(`/${p}/setup-pin`,{onSuccess:()=>{b(),a(),T(),y("phone")}})},L=()=>{j(`/${p}/otp/send`,{onSuccess:()=>{P(60)}})},E=(r,t)=>{var m;const n=r.target.value.replace(/\D/g,""),c=s.otp.split("");c[t]=n.charAt(n.length-1)||"",S("otp",c.join("")),n&&t<5&&d.current[t+1]&&((m=d.current[t+1])==null||m.focus())},$=(r,t,n,c)=>{var A,C;const m=r.target.value.replace(/\D/g,""),M=s[n].split("");M[t]=m.charAt(m.length-1)||"",S(n,M.join("")),m&&t<5&&c.current[t+1]&&((A=c.current[t+1])==null||A.focus()),n==="pin"&&M.join("").length===6&&g.current[0]&&((C=g.current[0])==null||C.focus())},_=(r,t,n)=>{var c;r.key==="Backspace"&&!s.otp[t]&&t>0&&n.current[t-1]&&((c=n.current[t-1])==null||c.focus())},R=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:l?"Masukkan Nomor HP Anda yang terdaftar":"Daftarkan Nomor HP Anda"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Kami akan mengirimkan kode OTP ke nomor ini ",e.jsx("br",{}),Z(k.tel??"")]})]}),o.phone&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.phone}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Handphone"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"+62"})}),e.jsx("input",{type:"tel",id:"phone",name:"phone",autoComplete:"tel",className:"block w-full rounded-md border border-gray-300 py-2 pl-12 focus:border-blue-500 focus:ring-blue-500",placeholder:"8123456789",value:s.phone,onChange:r=>S("phone",r.target.value.replace(/\D/g,"")),required:!0})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u||s.phone.length<10,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.phone.length>=10?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:u?"Mengirim OTP...":"Kirim Kode OTP"})})]})]}),B=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>y("phone"),className:"flex items-center text-sm text-gray-600 hover:text-gray-800",children:[e.jsx(J,{className:"mr-1 h-4 w-4"}),"Kembali"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Verifikasi OTP"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Masukkan 6 digit kode OTP yang dikirim ke +62",s.phone]})]}),o.otp&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.otp}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{d.current[t]=n},type:"text",inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.otp?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.otp[t]||"",onChange:n=>E(n,t),onKeyDown:n=>_(n,t,d),onFocus:n=>n.target.select()},t))}),e.jsx("div",{className:"text-center",children:x>0?e.jsxs("p",{className:"text-sm text-gray-500",children:["Kirim ulang OTP dalam ",x," detik"]}):e.jsx("button",{type:"button",onClick:L,className:"text-sm text-blue-600 hover:text-blue-800",children:"Kirim Ulang OTP"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u||s.otp.length!==6,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.otp.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:u?"Memverifikasi...":"Verifikasi"})})]})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Buat PIN 6 Digit Baru"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Untuk keamanan akun Anda"})]}),(o.pin||o.pin_confirmation)&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.pin||o.pin_confirmation}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Masukkan PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{h.current[t]=n},type:N,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin[t]||"",onChange:n=>$(n,t,"pin",h),onKeyDown:n=>_(n,t,h),onFocus:n=>n.target.select()},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin_confirmation",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Konfirmasi PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{g.current[t]=n},type:N,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin_confirmation?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin_confirmation[t]||"",onChange:n=>$(n,t,"pin_confirmation",g),onKeyDown:n=>_(n,t,g),onFocus:n=>n.target.select()},t))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:"flex items-center text-sm text-gray-600 hover:text-gray-800",onClick:()=>D(N==="password"?"text":"password"),children:N==="password"?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-1 h-4 w-4"}),"Tampilkan PIN"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-1 h-4 w-4"}),"Sembunyikan PIN"]})})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u||s.pin.length!==6||s.pin!==s.pin_confirmation,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.pin.length===6&&s.pin===s.pin_confirmation?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:u?"Menyimpan...":"Simpan PIN"})})]})]});return e.jsx(U,{isOpen:v,onClose:b,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(z,{title:f==="phone"?"Daftar Nomor HP":f==="otp"?"Verifikasi OTP":"Buat PIN"}),e.jsxs("div",{className:"w-full max-w-md rounded-lg",children:[w&&e.jsx("div",{className:`mb-4 text-center text-sm ${w.includes("berhasil")?"text-green-600":"text-red-500"}`,children:w}),f==="phone"&&R(),f==="otp"&&B(),f==="pin"&&H()]})]})})};export{ne as default};
