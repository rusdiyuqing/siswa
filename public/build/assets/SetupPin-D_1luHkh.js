import{K as R,r as c,m as B,j as e,L as H}from"./app-CTsPbqCq.js";import{c as w,M as q}from"./Modal-Dn-T28NW.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],z=w("ArrowLeft",V);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],G=w("EyeOff",U);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Q=w("Eye",J),Y=({hasPin:P,open:O,onClose:C})=>{const{message:g,errors:o,nouid:b}=R().props,[d,y]=c.useState("phone"),[m,j]=c.useState(0),{data:s,setData:N,post:f,processing:i}=B({phone:"",otp:"",pin:"",pin_confirmation:""}),[h,D]=c.useState("password"),l=c.useRef(Array(6).fill(null)),p=c.useRef(Array(6).fill(null)),x=c.useRef(Array(6).fill(null));c.useEffect(()=>{if(m>0){const r=setTimeout(()=>j(m-1),1e3);return()=>clearTimeout(r)}},[m]);const A=r=>{r.preventDefault();const t=P?route("siswa.forgot-pin"):route("otp.send");f(t,{onSuccess:()=>{y("otp"),j(60),l.current[0]&&l.current[0].focus()}})},T=r=>{r.preventDefault(),f(`/${b}/otp/verify`,{onSuccess:t=>{console.log(t),y("pin"),p.current[0]&&p.current[0].focus()}})},K=r=>{r.preventDefault(),f(`/${b}/setup-pin`)},$=()=>{f(`/${b}/otp/send`,{onSuccess:()=>{j(60)}})},I=(r,t)=>{var u;const n=r.target.value.replace(/\D/g,""),a=s.otp.split("");a[t]=n.charAt(n.length-1)||"",N("otp",a.join("")),n&&t<5&&l.current[t+1]&&((u=l.current[t+1])==null||u.focus())},S=(r,t,n,a)=>{var _,M;const u=r.target.value.replace(/\D/g,""),k=s[n].split("");k[t]=u.charAt(u.length-1)||"",N(n,k.join("")),u&&t<5&&a.current[t+1]&&((_=a.current[t+1])==null||_.focus()),n==="pin"&&k.join("").length===6&&x.current[0]&&((M=x.current[0])==null||M.focus())},v=(r,t,n)=>{var a;r.key==="Backspace"&&!s.otp[t]&&t>0&&n.current[t-1]&&((a=n.current[t-1])==null||a.focus())},F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:P?"Masukkan Nomor HP Anda yang terdaftar":"Daftarkan Nomor HP Anda"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Kami akan mengirimkan kode OTP ke nomor ini"})]}),o.phone&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.phone}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Handphone"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"+62"})}),e.jsx("input",{type:"tel",id:"phone",name:"phone",autoComplete:"tel",className:"block w-full rounded-md border border-gray-300 py-2 pl-12 focus:border-blue-500 focus:ring-blue-500",placeholder:"8123456789",value:s.phone,onChange:r=>N("phone",r.target.value.replace(/\D/g,"")),required:!0})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.phone.length<10,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.phone.length>=10?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Mengirim OTP...":"Kirim Kode OTP"})})]})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>y("phone"),className:"flex items-center text-sm text-gray-600 hover:text-gray-800",children:[e.jsx(z,{className:"mr-1 h-4 w-4"}),"Kembali"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Verifikasi OTP"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Masukkan 6 digit kode OTP yang dikirim ke +62",s.phone]})]}),o.otp&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.otp}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{l.current[t]=n},type:"text",inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.otp?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.otp[t]||"",onChange:n=>I(n,t),onKeyDown:n=>v(n,t,l),onFocus:n=>n.target.select()},t))}),e.jsx("div",{className:"text-center",children:m>0?e.jsxs("p",{className:"text-sm text-gray-500",children:["Kirim ulang OTP dalam ",m," detik"]}):e.jsx("button",{type:"button",onClick:$,className:"text-sm text-blue-600 hover:text-blue-800",children:"Kirim Ulang OTP"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.otp.length!==6,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.otp.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Memverifikasi...":"Verifikasi"})})]})]}),E=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Buat PIN 6 Digit Baru"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Untuk keamanan akun Anda"})]}),(o.pin||o.pin_confirmation)&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.pin||o.pin_confirmation}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Masukkan PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{p.current[t]=n},type:h,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin[t]||"",onChange:n=>S(n,t,"pin",p),onKeyDown:n=>v(n,t,p),onFocus:n=>n.target.select()},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin_confirmation",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Konfirmasi PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{x.current[t]=n},type:h,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin_confirmation?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin_confirmation[t]||"",onChange:n=>S(n,t,"pin_confirmation",x),onKeyDown:n=>v(n,t,x),onFocus:n=>n.target.select()},t))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:"flex items-center text-sm text-gray-600 hover:text-gray-800",onClick:()=>D(h==="password"?"text":"password"),children:h==="password"?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),"Tampilkan PIN"]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-1 h-4 w-4"}),"Sembunyikan PIN"]})})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.pin.length!==6||s.pin!==s.pin_confirmation,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.pin.length===6&&s.pin===s.pin_confirmation?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Menyimpan...":"Simpan PIN"})})]})]});return e.jsx(q,{isOpen:O,onClose:C,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(H,{title:d==="phone"?"Daftar Nomor HP":d==="otp"?"Verifikasi OTP":"Buat PIN"}),e.jsxs("div",{className:"w-full max-w-md rounded-lg",children:[g&&e.jsx("div",{className:`mb-4 text-center text-sm ${g.includes("berhasil")?"text-green-600":"text-red-500"}`,children:g}),d==="phone"&&F(),d==="otp"&&L(),d==="pin"&&E()]})]})})};export{Y as default};
