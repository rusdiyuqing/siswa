import{K as q,r as c,m as V,j as e,L as z}from"./app-CAX6Qfgz.js";import{c as w,M as U}from"./Modal-CVytuZP0.js";import{m as G}from"./utils-DUjf7G_t.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Q=w("ArrowLeft",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],X=w("EyeOff",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Z=w("Eye",Y),se=({setHasPined:D,hasPin:P,open:A,onClose:S})=>{const{siswa:C,message:y,errors:o,nouid:d}=q().props,[m,h]=c.useState("phone"),[p,j]=c.useState(0),{data:s,setData:N,post:g,processing:i,reset:T}=V({phone:"",otp:"",pin:"",pin_confirmation:""}),[b,K]=c.useState("password"),l=c.useRef(Array(6).fill(null)),x=c.useRef(Array(6).fill(null)),f=c.useRef(Array(6).fill(null));c.useEffect(()=>{if(p>0){const r=setTimeout(()=>j(p-1),1e3);return()=>clearTimeout(r)}},[p]);const $=r=>{r.preventDefault();const t=P?route("siswa.forgot-pin",{nouid:d}):route("otp.send",{nouid:d});g(t,{onSuccess:()=>{h("otp"),j(60),l.current[0]&&l.current[0].focus()}})},I=r=>{r.preventDefault(),g(`/${d}/otp/verify`,{onSuccess:()=>{h("pin"),x.current[0]&&x.current[0].focus()}})},F=r=>{r.preventDefault(),g(`/${d}/setup-pin`,{onSuccess:()=>{S(),D(),T(),h("phone")}})},L=()=>{g(`/${d}/otp/send`,{onSuccess:()=>{j(60)}})},E=(r,t)=>{var u;const n=r.target.value.replace(/\D/g,""),a=s.otp.split("");a[t]=n.charAt(n.length-1)||"",N("otp",a.join("")),n&&t<5&&l.current[t+1]&&((u=l.current[t+1])==null||u.focus())},_=(r,t,n,a)=>{var M,O;const u=r.target.value.replace(/\D/g,""),k=s[n].split("");k[t]=u.charAt(u.length-1)||"",N(n,k.join("")),u&&t<5&&a.current[t+1]&&((M=a.current[t+1])==null||M.focus()),n==="pin"&&k.join("").length===6&&f.current[0]&&((O=f.current[0])==null||O.focus())},v=(r,t,n)=>{var a;r.key==="Backspace"&&!s.otp[t]&&t>0&&n.current[t-1]&&((a=n.current[t-1])==null||a.focus())},R=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:P?"Masukkan Nomor HP Anda yang terdaftar":"Daftarkan Nomor HP Anda"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Kami akan mengirimkan kode OTP ke nomor ini ",e.jsx("br",{}),G(C.tel??"")]})]}),o.phone&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.phone}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Handphone"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"+62"})}),e.jsx("input",{type:"tel",id:"phone",name:"phone",autoComplete:"tel",className:"block w-full rounded-md border border-gray-300 py-2 pl-12 focus:border-blue-500 focus:ring-blue-500",placeholder:"8123456789",value:s.phone,onChange:r=>N("phone",r.target.value.replace(/\D/g,"")),required:!0})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.phone.length<10,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.phone.length>=10?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Mengirim OTP...":"Kirim Kode OTP"})})]})]}),B=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>h("phone"),className:"flex items-center text-sm text-gray-600 hover:text-gray-800",children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),"Kembali"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Verifikasi OTP"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Masukkan 6 digit kode OTP yang dikirim ke +62",s.phone]})]}),o.otp&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.otp}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{l.current[t]=n},type:"text",inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.otp?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.otp[t]||"",onChange:n=>E(n,t),onKeyDown:n=>v(n,t,l),onFocus:n=>n.target.select()},t))}),e.jsx("div",{className:"text-center",children:p>0?e.jsxs("p",{className:"text-sm text-gray-500",children:["Kirim ulang OTP dalam ",p," detik"]}):e.jsx("button",{type:"button",onClick:L,className:"text-sm text-blue-600 hover:text-blue-800",children:"Kirim Ulang OTP"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.otp.length!==6,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.otp.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Memverifikasi...":"Verifikasi"})})]})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Buat PIN 6 Digit Baru"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Untuk keamanan akun Anda"})]}),(o.pin||o.pin_confirmation)&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.pin||o.pin_confirmation}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Masukkan PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{x.current[t]=n},type:b,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin[t]||"",onChange:n=>_(n,t,"pin",x),onKeyDown:n=>v(n,t,x),onFocus:n=>n.target.select()},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin_confirmation",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Konfirmasi PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,t)=>e.jsx("input",{ref:n=>{f.current[t]=n},type:b,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin_confirmation?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:s.pin_confirmation[t]||"",onChange:n=>_(n,t,"pin_confirmation",f),onKeyDown:n=>v(n,t,f),onFocus:n=>n.target.select()},t))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:"flex items-center text-sm text-gray-600 hover:text-gray-800",onClick:()=>K(b==="password"?"text":"password"),children:b==="password"?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"mr-1 h-4 w-4"}),"Tampilkan PIN"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-1 h-4 w-4"}),"Sembunyikan PIN"]})})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i||s.pin.length!==6||s.pin!==s.pin_confirmation,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.pin.length===6&&s.pin===s.pin_confirmation?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:i?"Menyimpan...":"Simpan PIN"})})]})]});return e.jsx(U,{isOpen:A,onClose:S,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(z,{title:m==="phone"?"Daftar Nomor HP":m==="otp"?"Verifikasi OTP":"Buat PIN"}),e.jsxs("div",{className:"w-full max-w-md rounded-lg",children:[y&&e.jsx("div",{className:`mb-4 text-center text-sm ${y.includes("berhasil")?"text-green-600":"text-red-500"}`,children:y}),m==="phone"&&R(),m==="otp"&&B(),m==="pin"&&H()]})]})})};export{se as default};
