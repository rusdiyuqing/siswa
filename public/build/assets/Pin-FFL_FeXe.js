import{K as w,r as i,m as N,j as s,L as P,$ as k}from"./app-Dn5VNY7D.js";import{M as D}from"./Modal-DuikQhNP.js";const C=()=>{const{errors:p,nouid:x}=w().props,[l,f]=i.useState(!0),{data:a,setData:o,post:h,processing:d}=N({pin:"",nouid:""}),[u,g]=i.useState("password"),n=i.useRef(Array(6).fill(null));i.useEffect(()=>{const e=window.location.pathname.split("/")[1];o("nouid",e)},[o]),i.useEffect(()=>{var r;l&&n.current[0]&&((r=n.current[0])==null||r.focus())},[l]);const y=r=>{r.preventDefault(),/^\d{6}$/.test(a.pin)&&h(`/${a.nouid}/verify-pin`,{preserveState:!0,onError:()=>{var e;o("pin",""),n.current[0]&&((e=n.current[0])==null||e.focus())}})},b=(r,e)=>{var m;const t=r.target.value.replace(/\D/g,""),c=a.pin.split("");c[e]=t.charAt(t.length-1)||"",o("pin",c.join("")),t&&e<5&&n.current[e+1]&&((m=n.current[e+1])==null||m.focus())},j=(r,e)=>{var t;r.key==="Backspace"&&!a.pin[e]&&e>0&&n.current[e-1]&&((t=n.current[e-1])==null||t.focus())},v=r=>{var t;r.preventDefault();const e=r.clipboardData.getData("text/plain").replace(/\D/g,"").slice(0,6);if(e.length>0){o("pin",e);const c=Math.min(e.length-1,5);n.current[c]&&((t=n.current[c])==null||t.focus())}};return s.jsx(D,{isOpen:l,onClose:()=>f(!1),children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx(P,{title:"Masukkan PIN"}),s.jsxs("div",{className:"w-full max-w-md space-y-8",children:[s.jsx("div",{children:s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Masukkan PIN"})}),p.pin&&s.jsx("div",{className:"mb-4 text-center text-sm text-red-500",children:p.pin}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:y,children:[s.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,e)=>s.jsx("input",{ref:t=>{n.current[e]=t},type:u,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:"h-12 w-12 rounded-md border border-gray-300 text-center text-2xl focus:border-blue-500 focus:ring-blue-500 focus:outline-none",value:a.pin[e]||"",onChange:t=>b(t,e),onKeyDown:t=>j(t,e),onPaste:v},e))}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{type:"button",className:"text-sm text-gray-600 hover:text-gray-800",onClick:()=>g(u==="password"?"text":"password"),children:u==="password"?"Tampilkan PIN":"Sembunyikan PIN"})}),s.jsxs("div",{className:"flex flex-col space-y-2",children:[s.jsx("button",{type:"submit",disabled:d||a.pin.length!==6,className:`group relative flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white ${a.pin.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none":"cursor-not-allowed bg-gray-400"}`,children:d?"Memverifikasi...":"Masuk"}),s.jsx(k,{href:route("siswa.show-lupa-pin",x),className:"text-sm text-primary hover:text-primary/80",onClick:()=>f(!1),children:"Lupa PIN?"})]})]})]})]})})};export{C as default};
