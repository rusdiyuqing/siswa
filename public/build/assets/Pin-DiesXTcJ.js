import{K as P,m as D,r as i,j as t,L as I}from"./app-CAX6Qfgz.js";import{M}from"./Modal-CVytuZP0.js";import{u as S}from"./index-BOdxe4Ru.js";const K=({setOpenSetupPin:h,hasPin:p,open:l,onClose:d})=>{const{errors:m,nouid:g}=P().props,{data:a,setData:o,post:b,processing:f,reset:y}=D({pin:"",nouid:g??""}),[u,j]=i.useState("password"),n=i.useRef(Array(6).fill(null));i.useEffect(()=>{const e=window.location.pathname.split("/")[1];o("nouid",e)},[o]),i.useEffect(()=>{var r;l&&n.current[0]&&((r=n.current[0])==null||r.focus())},[l]);const N=r=>{r.preventDefault(),/^\d{6}$/.test(a.pin)&&b(`/${a.nouid}/verify-pin`,{preserveState:!0,onSuccess:()=>{d(),y()},onError:()=>{var e;o("pin",""),n.current[0]&&((e=n.current[0])==null||e.focus())}})},v=(r,e)=>{var x;const s=r.target.value.replace(/\D/g,""),c=a.pin.split("");c[e]=s.charAt(s.length-1)||"",o("pin",c.join("")),s&&e<5&&n.current[e+1]&&((x=n.current[e+1])==null||x.focus())},w=(r,e)=>{var s;r.key==="Backspace"&&!a.pin[e]&&e>0&&n.current[e-1]&&((s=n.current[e-1])==null||s.focus())},k=r=>{var s;r.preventDefault();const e=r.clipboardData.getData("text/plain").replace(/\D/g,"").slice(0,6);if(e.length>0){o("pin",e);const c=Math.min(e.length-1,5);n.current[c]&&((s=n.current[c])==null||s.focus())}};return t.jsx(M,{title:p?"":"Anda Belum Membuat PIN",isOpen:l,onClose:d,children:p?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(I,{title:"Masukkan PIN"}),t.jsxs("div",{className:"w-full max-w-md space-y-8",children:[t.jsx("div",{children:t.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Masukkan PIN"})}),m.pin&&t.jsx("div",{className:"mb-4 text-center text-sm text-red-500",children:m.pin}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:N,children:[t.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((r,e)=>t.jsx("input",{ref:s=>{n.current[e]=s},type:u,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:"h-12 w-12 rounded-md border border-gray-300 text-center text-2xl focus:border-blue-500 focus:ring-blue-500 focus:outline-none",value:a.pin[e]||"",onChange:s=>v(s,e),onKeyDown:s=>w(s,e),onPaste:k},e))}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{type:"button",className:"text-sm text-gray-600 hover:text-gray-800",onClick:()=>j(u==="password"?"text":"password"),children:u==="password"?"Tampilkan PIN":"Sembunyikan PIN"})}),t.jsx("div",{className:"flex flex-col space-y-2",children:t.jsx("button",{type:"submit",disabled:f||a.pin.length!==6,className:`group relative flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white ${a.pin.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none":"cursor-not-allowed bg-gray-400"}`,children:f?"Memverifikasi...":"Masuk"})})]})]})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 rounded-xl p-6 text-center",children:[t.jsx("p",{className:"max-w-md text-sm",children:"Silakan verifikasi nomor WhatsApp Anda dan buat PIN terlebih dahulu sebelum melanjutkan."}),t.jsxs("button",{onClick:h,className:"flex items-center justify-center space-x-2 rounded-xl border border-indigo-100 bg-white px-4 py-3 text-indigo-600 shadow-sm transition-colors hover:bg-indigo-50",children:[t.jsx(S,{className:"text-lg"}),t.jsx("span",{children:"Buat PIN"})]})]})})};export{K as default};
